<html>

<head>
  <meta charset="utf-8">
  <title>Report</title>
  <link href="http://127.0.0.1:8000/staticfiles/reports/report.css" rel="stylesheet" type="text/css" />
  <meta name="description" content="Report example">
</head>

<body>
  <article id="cover">
    <h1 style="color:#FF7043">Full Scan Report
      <br>
      {{scan_object.domain.name}}
      <div class="line"></div>
      {# generated date #}
      <span class="subheading">{% now "F j, Y" %}</span>
    </h1>
    <footer>
      Company Name
      Company Address
    </footer>
    <footer>
      your@company.com
      https://yourcompany.org
    </footer>
    <footer>
      Generated by reNgine
      https://github.com/yogeshojha/rengine
    </footer>
  </article>
  <article id="contents">
    <h2>&nbsp;</h2>
    <h3>Table of contents</h3>
    <ul>
      <li><a href="#quick-summary"></a></li>
      <li><a href="#interesting-recon-data"></a></li>
      <li><a href="#vulnerability-summary"></a></li>
      <li><a href="#reconnaissance-results"></a></li>
      <li><a href="#vulnerabilities-discovered"></a></li>
    </ul>
  </article>

  <article id="summary" style="page-break-before: always">
    <h2 id="quick-summary">Quick Summary</h2>
    <h4 class="light-title">This section contains quick summary of scan performed on <span id="primary-title">{{scan_object.domain.name}}</span></h4>
    <h3 id="reconnaissance-summary">Reconnaissance</h3>
  </article>
  <div id="vulnerability-boxes">
    <section>
      <p id="inside-box-title" class="success">Subdomains
        <br>
        <span id="vulnerability-count">
          {{scan_object.get_subdomain_count}}
        </span>
      </p>
    </section>
    <section>
      <p id="inside-box-title" class="grey">Endpoints
        <br>
        <span id="vulnerability-count">
          {{scan_object.get_endpoint_count}}
        </span>
      </p>
    </section>
    <section>
      <p id="inside-box-title" class="critical">Vulnerabilities
        <br>
        <span id="vulnerability-count">
          {{scan_object.get_vulnerability_count}}
        </span>
      </p>
    </section>
  </div>
  <article>
    <br>
    <h3 id="vulnerability-summary">Vulnerability Summary</h3>
    <div id="vulnerability-boxes">
      <section>
        <p id="inside-box-title" class="critical">Critical
          <br>
          <span id="vulnerability-count">
            {{scan_object.get_critical_vulnerability_count}}
          </span>
        </p>
      </section>
      <section>
        <p id="inside-box-title" class="high">High
          <br>
          <span id="vulnerability-count">
            {{scan_object.get_high_vulnerability_count}}
          </span>
        </p>
      </section>
      <section>
        <p id="inside-box-title" class="medium">Medium
          <br>
          <span id="vulnerability-count">
            {{scan_object.get_medium_vulnerability_count}}
          </span>
        </p>
      </section>
      <section>
        <p id="inside-box-title" class="low">Low
          <br>
          <span id="vulnerability-count">
            {{scan_object.get_low_vulnerability_count}}
          </span>
        </p>
      </section>
    </div>
    <span id="info_title">* {{scan_object.get_info_vulnerability_count}} Informational Vulnerabilities Identified</span>
  </article>
  <article>
    <h3 id="assessment-timeline">Timeline of the Assessment</h3>
    <p>
      Scan started on: {{scan_object.start_scan_date|date:"F j, Y h:i"}}
      <br>
      Total time taken:
      {% if scan_object.scan_status == 0 %}
      {{ scan_object.start_scan_date|timesince:scan_object.stop_scan_date }}
      {% elif scan_object.scan_status == 1 %}
      {{ scan_object.get_elapsed_time }}
      {% elif scan_object.scan_status == 2 %}
      {% if scan_object.get_completed_time_in_sec < 60 %}
      Completed in < 1 minutes {% else %} Completed in {{ scan_object.start_scan_date|timesince:scan_object.stop_scan_date }} {% endif %} {% elif scan_object.scan_status == 3 %} Aborted in
        {{ scan_object.start_scan_date|timesince:scan_object.stop_scan_date }} {% endif %} <br>
        Report Generated on: {% now "F j, Y" %}
    </p>
  </article>
  {% if interesting_subdomains %}
  <article style="page-break-before: always" class="summary">
    <h3 id="interesting-recon-data" class="bold-h3">Interesting Recon Data</h3>
    <h4 class="light-title">Listed below are the {{interesting_subdomains.count}} interesting subdomains identified on <span id="primary-title">{{scan_object.domain.name}}</span></h4>
    {% endif %}
    <div class="table">
      <div class="row header green-header">
        <div class="cell" style="width: 5%">
          #
        </div>
        <div class="cell" style="width: 33%">
          Subdomain
        </div>
        <div class="cell" style="width: 33%">
          Page title
        </div>
        <div class="cell" style="width: 13%">
          HTTP Status
        </div>
      </div>
      {% for subdomain in interesting_subdomains %}
      <div class="row">
        <div class="cell" style="width: 5%">
          {{ forloop.counter }}
        </div>
        <div class="cell" style="width: 35%">
          {{subdomain.name}}
        </div>
        <div class="cell" style="width: 35%">
          {% if subdomain.page_title %}
          {{subdomain.page_title}}
          {% endif %}
        </div>
        <div class="cell" style="width: 13%;">
          {{subdomain.http_status}}
        </div>
      </div>
    </div>
  </article>
  {% endfor %}
  <article style="page-break-before: always" class="summary">
    <h3 id="vulnerability-summary" class="bold-h3">Summary of Vulnerabilities Identified</h3>
    <h4 class="light-title">Listed below are the vulnerabilities identified on <span id="primary-title">{{scan_object.domain.name}}</span></h4>
    <div class="table">
      <div class="row header red-header">
        <div class="cell" style="width: 5%">
          #
        </div>
        <div class="cell" style="width: 50%">
          Vulnerability Name
        </div>
        <div class="cell" style="width: 19%;">
          Times Identified
        </div>
        <div class="cell" style="width: 15%">
          Severity
        </div>
      </div>
      {% for vulnerability in vulnerabilities %}
      <div class="row">
        <div class="cell" style="width: 5%">
          {{ forloop.counter }}
        </div>
        <div class="cell" style="width: 50%">
          {{vulnerability.name}}
        </div>
        <div class="cell" style="float: right; width: 19%;">
          {{vulnerability.count}}
        </div>
        {% if vulnerability.severity == 0 %}
        <div class="cell info-cell" style="width: 15%">
          <span class="severity-title-box">Informational</span>
        {% elif vulnerability.severity == 1 %}
          <div class="cell low" style="width: 15%">
          <span class="severity-title-box">Low</span>
        {% elif vulnerability.severity == 2 %}
          <div class="cell medium" style="width: 15%">
          <span class="severity-title-box">Medium</span>
        {% elif vulnerability.severity == 3 %}
          <div class="cell high" style="width: 15%">
          <span class="severity-title-box">High</span>
        {% elif vulnerability.severity == 4 %}
          <div class="cell critical" style="width: 15%">
          <span class="severity-title-box">Critical</span>
        {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
  </article>
  <article class="summary" style="page-break-before: always">
    <h2 id="reconnaissance-results">Reconnaissance Results</h2>
    <p>
      During the reconnaissance phase, {{scan_object.get_subdomain_count}} subdomains were discovered.
      Out of {{scan_object.get_subdomain_count}} subdomains, {{subdomain_alive_count}} returned HTTP status 200.
      {{interesting_subdomains.count}} interesting subdomains were also identified based on the interesting keywords used.
    </p>
    <h4>{{scan_object.get_subdomain_count}} subdomains identified on <span id="primary-title">{{scan_object.domain.name}}</span></h4>
    <div class="table">
      <div class="row header blue-header">
        <div class="cell" style="width: 38%">
          Subdomain
        </div>
        <div class="cell" style="width: 38%">
          Page title
        </div>
        <div class="cell" style="width: 18%">
          HTTP Status
        </div>
      </div>
      {% for subdomain in subdomains %}
      <div class="row">
        <div class="cell" style="width: 38%">
          {{subdomain.name}}
        </div>
        <div class="cell" style="width: 38%">
          {% if subdomain.page_title %}
          {{subdomain.page_title}}
          {% endif %}
        </div>
        <div class="cell" style="width: 18%">
          {{subdomain.http_status}}
        </div>
      </div>
      {% endfor %}
    </div>
  </article>
  <article style="page-break-before: always" class="summary">
    <h2 id="vulnerabilities-discovered">Vulnerabilities Discovered</h2>
    <p>
      Total of {{scan_object.get_vulnerability_count}} were discovered in {{scan_object.domain.name}},
      {{scan_object.get_critical_vulnerability_count}} of them were Critical,
      {{scan_object.get_high_vulnerability_count}} of them were High Severity,
      {{scan_object.get_medium_vulnerability_count}} of them were Medium severity,
      {{scan_object.get_low_vulnerability_count}} of them were Low severity, and
      {{scan_object.get_info_vulnerability_count}} of them were Informational.
    </p>
    <h3>Vulnerability Breakdown by Severity</h3>
    <div id="vulnerability-boxes">
      <section>
        <p id="inside-box-title" class="critical">Critical
          <br>
          <span id="vulnerability-count">
            {{scan_object.get_critical_vulnerability_count}}
          </span>
        </p>
      </section>
      <section>
        <p id="inside-box-title" class="high">High
          <br>
          <span id="vulnerability-count">
            {{scan_object.get_high_vulnerability_count}}
          </span>
        </p>
      </section>
      <section>
        <p id="inside-box-title" class="medium">Medium
          <br>
          <span id="vulnerability-count">
            {{scan_object.get_medium_vulnerability_count}}
          </span>
        </p>
      </section>
      <section>
        <p id="inside-box-title" class="low">Low
          <br>
          <span id="vulnerability-count">
            {{scan_object.get_low_vulnerability_count}}
          </span>
        </p>
      </section>
    </div>
    <span id="info_title">* {{scan_object.get_info_vulnerability_count}} Informational Vulnerabilities Identified</span>
  </article>
  {# start vulnerability #}
  <article class="">
    <h3>Vulnerability Details</h3>
    <br>
    {% for vulnerability in all_vulnerabilities %}
    <h3>
      {{vulnerability.name}}
      {% if vulnerability.severity == 0 %}
      <span style="float: right; font-size: 18px;" class="info-text">Informational</span>
    </h3>
    <div class="info-line"></div>
    {% elif vulnerability.severity == 1 %}
    <span style="float: right; font-size: 18px;" class="low-text">Low</span>
    </h3>
    <div class="low-line"></div>
    {% elif vulnerability.severity == 2 %}
    <span style="float: right; font-size: 18px;" class="medium-text">Medium</span>
    </h3>
    <div class="medium-line"></div>
    {% elif vulnerability.severity == 3 %}
    <span style="float: right; font-size: 18px;" class="high-text">High</span>
    </h3>
    <div class="high-line"></div>
    {% elif vulnerability.severity == 4 %}
    <span style="float: right; font-size: 18px;" class="critical-text">Critical</span>
    </h3>
    <div class="critical-line"></div>
    {% endif %}
    </div>
    <span style="float: left; font-size: 12px;">
      {{vulnerability.tags}}
    </span>
    <span style="float: right; font-size: 12px;">Discovered on: {{vulnerability.discovered_date}}</span>
    <br>
    <span>Vulnerable URL: {{vulnerability.http_url}}</span>
    <br>
    {% if vulnerability.description %}
    <span>
      {{vulnerability.description}}
    </span>
    {% endif %}
    <br><br>
    {% endfor %}
  </article>
</body>

</html>
